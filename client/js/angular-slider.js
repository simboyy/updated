;window.AngularSlider=(function(window,document,undefined){var version='2.7.1',AngularSlider={},docElement=document.documentElement,mod='modernizr',modElem=document.createElement(mod),mStyle=modElem.style,inputElem=document.createElement('input'),smile=':)',toString={}.toString,tests={},inputs={},attrs={},classes=[],slice=classes.slice,featureName,_hasOwnProperty=({}).hasOwnProperty,hasOwnProp;if(!is(_hasOwnProperty,'undefined')&&!is(_hasOwnProperty.call,'undefined')){hasOwnProp=function(object,property){return _hasOwnProperty.call(object,property);};}else{hasOwnProp=function(object,property){return((property in object)&&is(object.constructor.prototype[property],'undefined'));};}if(!Function.prototype.bind){Function.prototype.bind=function bind(that){var target=this;if(typeof target!="function"){throw new TypeError();}var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var F=function(){};F.prototype=target.prototype;var self=new F();var result=target.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result){return result;}return self;}else{return target.apply(that,args.concat(slice.call(arguments)));}};return bound;};}function setCss(str){mStyle.cssText=str;}function setCssAll(str1,str2){return setCss(prefixes.join(str1+';')+(str2||''));}function is(obj,type){return typeof obj===type;}function contains(str,substr){return!!~(''+str).indexOf(substr);}function testDOMProps(props,obj,elem){for(var i in props){var item=obj[props[i]];if(item!==undefined){if(elem===false)return props[i];if(is(item,'function')){return item.bind(elem||obj);}return item;}}return false;}function webforms(){AngularSlider['inputtypes']=(function(props){for(var i=0,bool,inputElemType,defaultView,len=props.length;i<len;i++){inputElem.setAttribute('type',inputElemType=props[i]);bool=inputElem.type!=='text';if(bool){inputElem.value=smile;inputElem.style.cssText='position:absolute;visibility:hidden;';if(/^range$/.test(inputElemType)&&inputElem.style.WebkitAppearance!==undefined){docElement.appendChild(inputElem);defaultView=document.defaultView;bool=defaultView.getComputedStyle&&defaultView.getComputedStyle(inputElem,null).WebkitAppearance!=='textfield'&&(inputElem.offsetHeight!==0);docElement.removeChild(inputElem);}else if(/^(search|tel)$/.test(inputElemType)){}else if(/^(url|email)$/.test(inputElemType)){bool=inputElem.checkValidity&&inputElem.checkValidity()===false;}else{bool=inputElem.value!=smile;}}inputs[props[i]]=!!bool;}return inputs;})('search tel url email datetime date month week time datetime-local number range color'.split(' '));}for(var feature in tests){if(hasOwnProp(tests,feature)){featureName=feature.toLowerCase();AngularSlider[featureName]=tests[feature]();classes.push((AngularSlider[featureName]?'':'no-')+featureName);}}AngularSlider.input||webforms();AngularSlider.addTest=function(feature,test){if(typeof feature=='object'){for(var key in feature){if(hasOwnProp(feature,key)){AngularSlider.addTest(key,feature[key]);}}}else{feature=feature.toLowerCase();if(AngularSlider[feature]!==undefined){return AngularSlider;}test=typeof test=='function'?test():test;if(typeof enableClasses!=="undefined"&&enableClasses){docElement.className+=' '+(test?'':'no-')+feature;}AngularSlider[feature]=test;}return AngularSlider;};setCss('');modElem=inputElem=null;AngularSlider._version=version;return AngularSlider;})(this,this.document);(function(a,b,c){function d(a){return"[object Function]"==o.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=p.shift();q=1,a?a.t?m(function(){("c"==a.t?B.injectCss:B.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):q=0}function i(a,c,d,e,f,i,j){function k(b){if(!o&&g(l.readyState)&&(u.r=o=1,!q&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&m(function(){t.removeChild(l)},50);for(var d in y[c])y[c].hasOwnProperty(d)&&y[c][d].onload()}}var j=j||B.errorTimeout,l=b.createElement(a),o=0,r=0,u={t:d,s:c,e:f,a:i,x:j};1===y[c]&&(r=1,y[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,r)},p.splice(e,0,u),"img"!=a&&(r||2===y[c]?(t.insertBefore(l,s?null:n),m(k,j)):y[c].push(l))}function j(a,b,c,d,f){return q=0,b=b||"j",e(a)?i("c"==b?v:u,a,b,this.i++,c,d,f):(p.splice(this.i++,0,a),1==p.length&&h()),this}function k(){var a=B;return a.loader={load:j,i:0},a}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance"in l.style,s=r&&!!b.createRange().compareNode,t=s?l:n.parentNode,l=a.opera&&"[object Opera]"==o.call(a.opera),l=!!b.attachEvent&&!l,u=r?"object":l?"script":"img",v=l?"script":u,w=Array.isArray||function(a){return"[object Array]"==o.call(a)},x=[],y={},z={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}},A,B;B=function(a){function b(a){var a=a.split("!"),b=x.length,c=a.pop(),d=a.length,c={url:c,origUrl:c,prefixes:a},e,f,g;for(f=0;f<d;f++)g=a[f].split("="),(e=z[g.shift()])&&(c=e(c,g));for(f=0;f<b;f++)c=x[f](c);return c}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(y[i.url]?i.noexec=!0:y[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),y[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}),g(a,j,b,0,h);else if(Object(a)===a)for(n in m=function(){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}(),a)a.hasOwnProperty(n)&&(!c&&!--m&&(d(j)?j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}:j[n]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),l()}}(k[n])),g(a[n],j,b,n,h))}else!c&&l()}var h=!!a.test,i=a.load||a.both,j=a.callback||f,k=j,l=a.complete||f,m,n;c(h?a.yep:a.nope,!!i),i&&c(i)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(w(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):w(j)?B(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},B.addPrefix=function(a,b){z[a]=b},B.addFilter=function(a){x.push(a)},B.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",A=function(){b.removeEventListener("DOMContentLoaded",A,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k=b.createElement("script"),l,o,e=e||B.errorTimeout;k.src=a;for(o in d)k.setAttribute(o,d[o]);c=j?h:c||f,k.onreadystatechange=k.onload=function(){!l&&g(k.readyState)&&(l=1,c(),k.onload=k.onreadystatechange=null)},m(function(){l||(l=1,c(1))},e),i?k.onload():n.parentNode.insertBefore(k,n)},a.yepnope.injectCss=function(a,c,d,e,g,i){var e=b.createElement("link"),j,c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(n.parentNode.insertBefore(e,n),m(c,0))}})(this,document);AngularSlider.load=function(){yepnope.apply(window,[].slice.call(arguments,0));};;angular.module('vr.directives.slider',['ngTouch']).directive('slider',['$timeout','$document','$interpolate','$swipe',function($timeout,$document,$interpolate,$swipe){var KNOB_STICKINESS=3;var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol();function angularize(element){return angular.element(element);}function pixelize(position){return""+position+"px";}function setOpacity(element,opacity){return element.css({opacity:opacity});}function hide(element){return setOpacity(element,0);}function show(element){return setOpacity(element,1);}function offset(element,position){return element.css({left:position});}function width(element){var width=parseFloat(element.css('width'));return isNaN(width)?element[0].offsetWidth:width;}function halfWidth(element){return width(element)/2;}function offsetLeft(element){try{return element.offset().left;}catch(e){}return element[0].getBoundingClientRect().left;}function gap(element1,element2){if(offsetLeft(element1)>offsetLeft(element2)){return offsetLeft(element1)-offsetLeft(element2)-width(element2);}return offsetLeft(element2)-offsetLeft(element1)-width(element1);}function bindHtml(element,html){return element.attr('ng-bind-template',html);}function roundToStep(value,precision,step,floor,ceiling){if(angular.isUndefined(precision)||!precision){precision=0;}if(angular.isUndefined(step)||!step||step==0){step=1/Math.pow(10,precision);}if(angular.isUndefined(floor)||!floor){floor=0;}if(angular.isUndefined(value)||!value){value=0;}var remainder=(value-floor)%step;var roundedValue=remainder>(step/2)?value+step-remainder:value-remainder;if(angular.isUndefined(ceiling)||!ceiling){ceiling=roundedValue;}roundedValue=Math.min(Math.max(roundedValue,floor),ceiling);return parseFloat(roundedValue.toFixed(precision));}function roundTo(value,step){return Math.floor((value/step)+0.5)*step;}function stepBuffer(step,buffer){if(step>0&&!isNaN(buffer)){return Math.ceil(buffer/step)*step;}return buffer;}function expression(exp){return startSymbol+" "+exp+" "+endSymbol;}return{restrict:'EA',require:'ngModel',scope:{floor:'@',ceiling:'@',step:'@',stepWidth:'@',precision:'@',buffer:'@',stickiness:'@',showSteps:'@',ngModel:'=',ngModelRange:'=',ngDisabled:'=',ngChange:'&',translateFn:'&',translateRangeFn:'&',translateCombinedFn:'&',scaleFn:'&',inverseScaleFn:'&'},template:"<span class='bar full'></span>"+"<span class='bar steps'><span class='bubble step' ng-repeat='step in stepBubbles()'></span></span>"+"<span class='bar selection'></span><span class='bar unselected low'></span><span class='bar unselected high'></span>"+"<span class='pointer low'></span><span class='pointer high'></span>"+"<span class='bubble low'></span><span class='bubble high'></span><span class='bubble middle'></span><span class='bubble selection'></span>"+"<span class='bubble limit floor'></span><span class='bubble limit ceiling'></span>"+"<input type='range' class='input low' /><input type='range' class='input high' /><input type='range' class='input selection' />",compile:function(element,attributes){var showSteps=attributes.showSteps;var stepWidth=attributes.stepWidth?'stepWidth':'step';var isDualKnob=attributes.ngModelRange!=null,refs={},refLow='ngModel',refHigh='ngModelRange',refSel='selectBar',watchables=['floor','ceiling','stickiness',refLow];function getReferences(el){if(!el){el=element;}var refs=[];angular.forEach(el.children(),function(el){refs.push(angularize(el));});return refs;}function setReferences(refs,dual,inputs){return{fullBar:refs[0],stepBubs:refs[1],selBar:dual?refs[2]:null,unSelBarLow:dual?refs[3]:null,unSelBarHigh:dual?refs[4]:null,minPtr:dual?refs[5]:refs[2],maxPtr:dual?refs[6]:null,lowBub:dual?refs[7]:refs[3],highBub:dual?refs[8]:null,cmbBub:dual?refs[9]:null,selBub:dual?refs[10]:null,flrBub:dual?refs[11]:refs[4],ceilBub:dual?refs[12]:refs[5],minInput:inputs?(dual?refs[13]:refs[6]):null,maxInput:inputs?(dual?refs[14]:null):null,selInput:inputs?(dual?refs[15]:null):null};}refs=(function(){var _ref=getReferences();var _results=[];for(var _i=0,_len=_ref.length;_i<_len;_i++){var e=_ref[_i];e=angularize(e);e.css({'white-space':'nowrap',position:'absolute',display:'block','z-index':1});_results.push(e);}return _results;})();refs=setReferences(refs,true,true);if(attributes.translateFn){attributes.$set('translateFn',""+attributes.translateFn+"(value)");}if(attributes.translateRangeFn){attributes.$set('translateRangeFnFn',""+attributes.translateRangeFn+"(low,high)");}if(attributes.translateCombinedFn){attributes.$set('translateCombinedFnFn',""+attributes.translateCombinedFn+"(low,high)");}if(attributes.scaleFn){attributes.$set('scaleFn',""+attributes.scaleFn+"(value)");}if(attributes.inverseScaleFn){attributes.$set('inverseScaleFn',""+attributes.inverseScaleFn+"(value)");}refs.fullBar.css({left:0,right:0});if(AngularSlider.inputtypes.range){var inputStyles={position:'absolute',margin:0,padding:0,opacity:0,height:'100%'};refs.minInput.attr('step',expression("inputSteps()"));refs.minInput.attr('min',expression("floor"));refs.minInput.css(inputStyles);refs.minInput.css('left',0);if(isDualKnob){refs.minInput.attr('max',expression("ngModelRange - (buffer / 2)"));refs.maxInput.attr('step',expression("inputSteps()"));refs.maxInput.attr('min',expression("ngModel + (buffer / 2)"));refs.maxInput.attr('max',expression("ceiling"));refs.maxInput.css(inputStyles);refs.selInput.attr('step',expression("inputSteps()"));refs.selInput.attr('min',expression("ngModel"));refs.selInput.attr('max',expression("ngModelRange"));refs.selInput.css(inputStyles);}else{refs.minInput.attr('max',expression("ceiling"));refs.minInput.css({width:'100%'});refs.maxInput.remove();refs.selInput.remove();}}else{refs.minInput.remove();refs.maxInput.remove();refs.selInput.remove();}bindHtml(refs.stepBubs.children().eq(0),expression("translation(step)"));bindHtml(refs.ceilBub,expression("translation(ceiling)"));bindHtml(refs.flrBub,expression("translation(floor)"));bindHtml(refs.selBub,expression("rangeTranslation("+refLow+","+refHigh+")"));bindHtml(refs.lowBub,expression("translation("+refLow+")"));bindHtml(refs.highBub,expression("translation("+refHigh+")"));bindHtml(refs.cmbBub,expression("combinedTranslation("+refLow+","+refHigh+")"));if(isDualKnob){watchables.push(refHigh);watchables.unshift('buffer');}else{var _ref1=[refs.selBar,refs.unSelBarLow,refs.unSelBarHigh,refs.maxPtr,refs.selBub,refs.highBub,refs.cmbBub];for(var _i=0,_len=_ref1.length;_i<_len;_i++){element=_ref1[_i];element.remove();}}watchables.unshift('precision',stepWidth);if(!showSteps){refs.stepBubs.children().remove();}return{post:function(scope,element,attributes,ctrl){var refs=setReferences(getReferences(element),isDualKnob,AngularSlider.inputtypes.range);scope.decodedValues={floor:0,ceiling:0,step:0,stepWidth:0,precision:0,buffer:0,stickiness:0,ngModel:0,ngModelRange:0};scope.translation=function(value){value=parseFloat(value).toFixed(scope.precision);if(angular.isUndefined(attributes.translateFn)){return''+value;}return scope.translateFn({value:value});};scope.rangeTranslation=function(low,high){if(angular.isUndefined(attributes.translateRangeFn)){return"Range: "+scope.translation((high-low).toFixed(scope.precision));}return scope.translateRangeFn({low:low,high:high});};scope.combinedTranslation=function(low,high){if(angular.isUndefined(attributes.translateCombinedFn)){return scope.translation(low)+" - "+scope.translation(high);}return scope.translateCombinedFn({low:low,high:high});};scope.encode=function(value){if(angular.isUndefined(attributes.scaleFn)||attributes.scaleFn==''){return value;}return scope.scaleFn({value:value});};scope.decode=function(value){if(angular.isUndefined(attributes.inverseScaleFn)||attributes.inverseScaleFn==''){return value;}return scope.inverseScaleFn({value:value});};if(Math.round(scope.encode(scope.decode(1)))!=1||Math.round(scope.encode(scope.decode(100)))!=100){console.warn("The scale and inverseScale functions are not perfect inverses: 1 = "+scope.encode(scope.decode(1))+"  100 = "+scope.encode(scope.decode(100)));}scope.decodeRef=function(ref){return scope.decode(scope[ref]);};scope.inputSteps=function(){return Math.pow(10,scope.precision*-1);};var barWidth=0;var pointerHalfWidth=0;var minOffset=0;var maxOffset=0;var offsetRange=0;var minValue=0;var minValueDecoded=0;var maxValue=0;var maxValueDecoded=0;var valueRange=0;var valueRangeDecoded=0;var stepRange=1;var stickyOffsetLow=0;var stickyOffsetHigh=0;var eventsBound=false;function dimensions(){angular.forEach(watchables,function(watchable){scope[watchable]=parseFloat(scope[watchable]);if(watchable==refLow||watchable==refHigh){scope[watchable]=roundToStep(scope[watchable],scope.precision,scope[stepWidth],scope.floor,scope.ceiling);}else if(watchable=='buffer'){if(!scope.buffer||isNaN(scope.buffer)||scope.buffer<0){scope.buffer=0;}else{scope.buffer=stepBuffer(scope[stepWidth],scope.buffer);}}else if(watchable=='precision'){if(!scope.precision||isNaN(scope.precision)){scope.precision=0;}else{scope.precision=parseInt(scope.precision);}}else if(watchable==stepWidth){if(!scope[stepWidth]||isNaN(scope[stepWidth])){scope[stepWidth]=1/Math.pow(10,scope.precision);}else{scope[stepWidth]=parseFloat(scope[stepWidth].toFixed(scope.precision));}}else if(watchable=='stickiness'){if(isNaN(scope.stickiness)){scope.stickiness=KNOB_STICKINESS;}else if(scope.stickiness<1){scope.stickiness=1;}}scope.decodedValues[watchable]=scope.decodeRef(watchable);});if(isDualKnob){if(scope[refHigh]<scope[refLow]){var temp=scope[refHigh];scope[refHigh]=scope[refLow];scope[refLow]=temp;}var diff=roundToStep(scope[refHigh]-scope[refLow],scope.precision,scope[stepWidth]);if(scope.buffer>0&&diff<scope.buffer){var avg=scope.encode((scope.decodedValues[refLow]+scope.decodedValues[refHigh])/2);scope[refLow]=roundToStep(avg-(scope.buffer/2),scope.precision,scope[stepWidth],scope.floor,scope.ceiling);scope[refHigh]=scope[refLow]+scope.buffer;if(scope[refHigh]>scope.ceiling){scope[refHigh]=scope.ceiling;scope[refLow]=scope.ceiling-scope.buffer;}}}barWidth=width(refs.fullBar);pointerHalfWidth=halfWidth(refs.minPtr);minOffset=offsetLeft(refs.fullBar);maxOffset=minOffset+barWidth-width(refs.minPtr);offsetRange=maxOffset-minOffset;minValue=scope.floor;minValueDecoded=scope.decodedValues.floor;maxValue=scope.ceiling;maxValueDecoded=scope.decodedValues.ceiling;valueRange=maxValue-minValue;valueRangeDecoded=maxValueDecoded-minValueDecoded;stepRange=roundTo(valueRangeDecoded,scope.decodedValues[stepWidth]);}function updateDOM(){var dragRange,lowValueOffset,highValueOffset,pointer,ref;dimensions();offset(refs.flrBub,0);offset(refs.ceilBub,pixelize(barWidth-width(refs.ceilBub)));function percentFromOffset(offset){return((offset-minOffset)/offsetRange)*100;}function decodedValueFromOffset(offset){return percentFromOffset(offset)/100*valueRangeDecoded+minValueDecoded;}function valueFromOffset(offset){return scope.encode(decodedValueFromOffset(offset));}function offsetFromDecodedValue(value){return((value-minValueDecoded)*offsetRange)+minOffset;}function offsetFromValue(value){return offsetFromDecodedValue(scope.decode(value));}function percentFromDecodedValue(value){var percent=value-minValueDecoded;if(valueRange==valueRangeDecoded){percent=roundTo(percent,scope.decodedValues[stepWidth])/stepRange;}else{percent/=valueRangeDecoded;}return percent*100;}function percentFromValue(value){return percentFromDecodedValue(scope.decode(value));}function offsetFromPercent(percent){return pixelize(percent*offsetRange/100);}function bringOffsetInRange(offset){return Math.min(Math.max(offset,minOffset),maxOffset);}function fitToBar(element){return offset(element,offsetFromPercent(percentFromOffset(bringOffsetInRange(offsetLeft(element)))));}function percentStretch(percent,maxPercent,end){var sign=percent>0?1:-1;maxPercent=!maxPercent?100:maxPercent;if(end){return(Math.sin((Math.min(Math.abs(percent/maxPercent),1)*Math.PI)-(Math.PI/2))+1)*sign*maxPercent/6;}return(sign*Math.pow(Math.min(Math.abs(percent/maxPercent*2),1),scope.stickiness)*maxPercent/2);}function setPointers(){var rawLowPercent=percentFromDecodedValue(scope.decodedValues[refLow]);var stepWidthPercentAboveLow=percentFromValue(scope[refLow]+scope[stepWidth])-rawLowPercent;var stepWidthPercentBelowLow=rawLowPercent-percentFromValue(scope[refLow]-scope[stepWidth]);var bufferWidthPercentLow=percentFromValue(scope[refLow]+scope.buffer)-rawLowPercent;var ptrHalfWidthPercent=percentFromOffset(pointerHalfWidth+minOffset);var stretchedLowPercent=rawLowPercent+percentStretch(stickyOffsetLow,stickyOffsetLow>0?stepWidthPercentAboveLow:stepWidthPercentBelowLow);offset(refs.minPtr,offsetFromPercent(stretchedLowPercent));offset(refs.lowBub,offsetFromPercent(percentFromOffset(offsetLeft(refs.minPtr)-halfWidth(refs.lowBub)+pointerHalfWidth)));if(isDualKnob){var rawHighPercent=percentFromDecodedValue(scope.decodedValues[refHigh]);var stepWidthPercentAboveHigh=percentFromValue(scope[refHigh]+scope[stepWidth])-rawHighPercent;var stepWidthPercentBelowHigh=rawHighPercent-percentFromValue(scope[refHigh]-scope[stepWidth]);var bufferWidthPercentHigh=rawHighPercent-percentFromValue(scope[refHigh]-scope.buffer);var stretchedHighPercent=rawHighPercent+percentStretch(stickyOffsetHigh,stickyOffsetHigh>0?stepWidthPercentAboveHigh:stepWidthPercentBelowHigh);if(stretchedLowPercent>rawHighPercent-bufferWidthPercentHigh){stretchedLowPercent=rawLowPercent+percentStretch(stickyOffsetLow,bufferWidthPercentLow,true);offset(refs.minPtr,offsetFromPercent(stretchedLowPercent));offset(refs.lowBub,offsetFromPercent(percentFromOffset(offsetLeft(refs.minPtr)-halfWidth(refs.lowBub)+pointerHalfWidth)));}if(stretchedHighPercent<rawLowPercent+bufferWidthPercentLow){stretchedHighPercent=rawHighPercent+percentStretch(stickyOffsetHigh,bufferWidthPercentHigh,true);}offset(refs.maxPtr,offsetFromPercent(stretchedHighPercent));offset(refs.highBub,offsetFromPercent(percentFromOffset(offsetLeft(refs.maxPtr)-halfWidth(refs.highBub)+pointerHalfWidth)));offset(refs.selBar,offsetFromPercent(stretchedLowPercent+ptrHalfWidthPercent));refs.selBar.css({width:offsetFromPercent(stretchedHighPercent-stretchedLowPercent)});offset(refs.selBub,offsetFromPercent(((stretchedLowPercent+stretchedHighPercent)/2)-percentFromOffset(halfWidth(refs.selBub)+minOffset)+ptrHalfWidthPercent));offset(refs.cmbBub,offsetFromPercent(((stretchedLowPercent+stretchedHighPercent)/2)-percentFromOffset(halfWidth(refs.cmbBub)+minOffset)+ptrHalfWidthPercent));refs.unSelBarLow.css({left:0,width:offsetFromPercent(stretchedLowPercent+ptrHalfWidthPercent)});offset(refs.unSelBarHigh,offsetFromPercent(stretchedHighPercent+ptrHalfWidthPercent));refs.unSelBarHigh.css({right:0});if(AngularSlider.inputtypes.range){var ptrWidth=ptrHalfWidthPercent*2;var highInputLeft=stretchedLowPercent+(bufferWidthPercentLow/2);var highInputWidth=100-highInputLeft;highInputLeft+=ptrWidth;var lowInputWidth=stretchedHighPercent-(bufferWidthPercentHigh/2);var selInputLeft=stretchedLowPercent+ptrWidth;var selInputWidth=stretchedHighPercent-stretchedLowPercent-ptrWidth;if(stretchedHighPercent<=stretchedLowPercent+ptrWidth){selInputLeft=stretchedLowPercent;selInputWidth=stretchedHighPercent+ptrWidth-stretchedLowPercent;}refs.minInput.css({width:offsetFromPercent(lowInputWidth)});refs.maxInput.css({left:offsetFromPercent(highInputLeft),width:offsetFromPercent(highInputWidth)});refs.selInput.css({left:offsetFromPercent(selInputLeft),width:offsetFromPercent(selInputWidth)});}}}function adjustBubbles(){var bubToAdjust=refs.lowBub;fitToBar(refs.lowBub);if(isDualKnob){fitToBar(refs.highBub);fitToBar(refs.selBub);if(gap(refs.lowBub,refs.highBub)<10){hide(refs.lowBub);hide(refs.highBub);show(refs.cmbBub);fitToBar(refs.cmbBub);bubToAdjust=refs.cmbBub;}else{show(refs.lowBub);show(refs.highBub);hide(refs.cmbBub);bubToAdjust=refs.highBub;}}if(gap(refs.flrBub,refs.lowBub)<5){hide(refs.flrBub);}else{if(isDualKnob){if(gap(refs.flrBub,bubToAdjust)<5){hide(refs.flrBub);}else{show(refs.flrBub);}}else{show(refs.flrBub);}}if(gap(refs.lowBub,refs.ceilBub)<5){hide(refs.ceilBub);}else{if(isDualKnob){if(gap(bubToAdjust,refs.ceilBub)<5){hide(refs.ceilBub);}else{show(refs.ceilBub);}}else{show(refs.ceilBub);}}}function onEnd(){stickyOffsetLow=0;stickyOffsetHigh=0;if(pointer){setPointers();adjustBubbles();pointer.removeClass('active');}pointer=null;ref=null;dragRange=false;}function onMove(event){if(pointer){scope.$apply(function(){var currentX=event.clientX||event.x;if(dragRange){var newLowValue=valueFromOffset(currentX)-lowValueOffset;var newHighValue=valueFromOffset(currentX)+highValueOffset;if(newLowValue<minValue){newHighValue+=minValue-newLowValue;newLowValue=minValue;}else if(newHighValue>maxValue){newLowValue-=newHighValue-maxValue;newHighValue=maxValue;}var newLowPercent=percentFromValue(newLowValue);var newHighPercent=percentFromValue(newHighValue);stickyOffsetLow=newLowPercent;stickyOffsetHigh=newHighPercent;scope[refLow]=newLowValue=roundToStep(newLowValue,scope.precision,scope[stepWidth],scope.floor,scope.ceiling);scope[refHigh]=newHighValue=roundToStep(newHighValue,scope.precision,scope[stepWidth],scope.floor,scope.ceiling);stickyOffsetLow=stickyOffsetLow-percentFromValue(newLowValue);stickyOffsetHigh=stickyOffsetHigh-percentFromValue(newHighValue);}else{var newOffset=bringOffsetInRange(currentX+minOffset-offsetLeft(element)-halfWidth(pointer));var newPercent=percentFromOffset(newOffset);var newValue=scope.encode(minValueDecoded+(valueRangeDecoded*newPercent/100.0));stickyOffsetLow=newPercent;if(isDualKnob){if(scope.buffer>0){if(ref===refLow){if(newValue>scope[refHigh]-scope.buffer){newValue=scope[refHigh]-scope.buffer}}else{if(newValue<scope[refLow]+scope.buffer){newValue=scope[refLow]+scope.buffer;}}}else{if(ref===refLow){if(newValue>scope[refHigh]){scope[refLow]=scope[refHigh];scope.decodedValues[refLow]=scope.decodeRef(refLow);ref=refHigh;var temp=refs.minPtr;refs.minPtr=refs.maxPtr;refs.maxPtr=temp;refs.maxPtr.removeClass('active').removeClass('high').addClass('low');refs.minPtr.addClass('active').removeClass('low').addClass('high');}}else{if(newValue<scope[refLow]){scope[refHigh]=scope[refLow];scope.decodedValues[refHigh]=scope.decodeRef(refHigh);ref=refLow;var temp=refs.minPtr;refs.minPtr=refs.maxPtr;refs.maxPtr=temp;refs.minPtr.removeClass('active').removeClass('low').addClass('high');refs.maxPtr.addClass('active').removeClass('high').addClass('low');}}}}scope[ref]=newValue=roundToStep(newValue,scope.precision,scope[stepWidth],scope.floor,scope.ceiling);scope.decodedValues[ref]=scope.decodeRef(ref);if(ref===refLow){stickyOffsetLow=stickyOffsetLow-percentFromValue(newValue);stickyOffsetHigh=0;}else{stickyOffsetHigh=stickyOffsetLow-percentFromValue(newValue);stickyOffsetLow=0;}}if(scope.ngChange){scope.ngChange();}ctrl.$setViewValue(scope[refLow]);setPointers();adjustBubbles();});}}function onStart(event,ptr,rf){if(scope.ngDisabled&&scope.ngDisabled==true)return;var currentX=event.clientX||event.x;pointer=ptr;ref=rf;pointer.addClass('active');if(ref==refSel){dragRange=true;var startValue=valueFromOffset(currentX);lowValueOffset=startValue-scope[refLow];highValueOffset=scope[refHigh]-startValue;}onMove(event);}function setBindings(){if(AngularSlider.inputtypes.range){function bindSlider(elem,ptr,rf){elem=angularize(elem);function start(ev){onStart(ev,ptr,rf);}function end(ev){onMove(ev);onEnd();}$swipe.bind(elem,{start:start,move:onMove,end:end,cancel:onEnd});}bindSlider(refs.minInput,refs.minPtr,refLow);if(isDualKnob){bindSlider(refs.maxInput,refs.maxPtr,refHigh);bindSlider(refs.selInput,refs.selBar,refSel);}}else{function bindSwipeStart(elem,rf,ptr){elem=angularize(elem);if(angular.isUndefined(ptr)){ptr=elem;}else{ptr=angularize(ptr);}$swipe.bind(elem,{start:function(ev){onStart(ev,ptr,rf);}});}function bindSwipe(elem){elem=angularize(elem);$swipe.bind(elem,{move:onMove,end:function(ev){onMove(ev);onEnd();},cancel:onEnd});}bindSwipe($document);bindSwipeStart(refs.minPtr,refLow);bindSwipeStart(refs.lowBub,refLow);bindSwipeStart(refs.flrBub,refLow,refs.minPtr);if(isDualKnob){bindSwipeStart(refs.maxPtr,refHigh);bindSwipeStart(refs.highBub,refHigh);bindSwipeStart(refs.ceilBub,refHigh,refs.maxPtr);bindSwipeStart(refs.selBar,refSel);bindSwipeStart(refs.selBub,refSel,refs.selBar);bindSwipeStart(refs.unSelBarLow,refLow,refs.minPtr);bindSwipeStart(refs.unSelBarHigh,refHigh,refs.maxPtr);}else{bindSwipeStart(refs.ceilBub,refLow,refs.minPtr);bindSwipeStart(refs.fullBar,refLow,refs.minPtr);}}}setPointers();adjustBubbles();if(!eventsBound){setBindings();eventsBound=true;}}for(var i=0;i<watchables.length;i++){scope.$watch(watchables[i],function(){updateDOM();});}angularize(window).bind("resize",function(){updateDOM();});scope.$on('refreshSlider',function(){$timeout(function(){updateDOM();});});$timeout(function(){updateDOM();});}};}}}]);