(function(root,factory){'use strict';if(typeof define==='function'&&define.amd){define(['angular'],factory);}else if(typeof module==='object'&&module.exports){var angularObj=angular||require('angular');if((!angularObj||!angularObj.module)&&typeof angular!='undefined'){angularObj=angular;}module.exports=factory(angularObj);}else{factory(root.angular);}}(this,function(angular){'use strict';var module=angular.module('rzModule',[]).factory('RzSliderOptions',function(){var defaultOptions={floor:0,ceil:null,step:1,precision:0,minRange:null,maxRange:null,pushRange:false,minLimit:null,maxLimit:null,id:null,translate:null,getLegend:null,stepsArray:null,bindIndexForStepsArray:false,draggableRange:false,draggableRangeOnly:false,showSelectionBar:false,showSelectionBarEnd:false,showSelectionBarFromValue:null,hidePointerLabels:false,hideLimitLabels:false,autoHideLimitLabels:true,readOnly:false,disabled:false,interval:350,showTicks:false,showTicksValues:false,ticksArray:null,ticksTooltip:null,ticksValuesTooltip:null,vertical:false,getSelectionBarColor:null,getTickColor:null,getPointerColor:null,keyboardSupport:true,scale:1,enforceStep:true,enforceRange:false,noSwitching:false,onlyBindHandles:false,onStart:null,onChange:null,onEnd:null,rightToLeft:false,boundPointerLabels:true,mergeRangeLabelsIfSame:false,customTemplateScope:null,logScale:false,customValueToPosition:null,customPositionToValue:null,selectionBarGradient:null};var globalOptions={};var factory={};factory.options=function(value){angular.extend(globalOptions,value);};factory.getOptions=function(options){return angular.extend({},defaultOptions,globalOptions,options);};return factory;}).factory('rzThrottle',['$timeout',function($timeout){return function(func,wait,options){'use strict';var getTime=(Date.now||function(){return new Date().getTime();});var context,args,result;var timeout=null;var previous=0;options=options||{};var later=function(){previous=getTime();timeout=null;result=func.apply(context,args);context=args=null;};return function(){var now=getTime();var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){$timeout.cancel(timeout);timeout=null;previous=now;result=func.apply(context,args);context=args=null;}else if(!timeout&&options.trailing!==false){timeout=$timeout(later,remaining);}return result;};}}]).factory('RzSlider',['$timeout','$document','$window','$compile','RzSliderOptions','rzThrottle',function($timeout,$document,$window,$compile,RzSliderOptions,rzThrottle){'use strict';var Slider=function(scope,sliderElem){this.scope=scope;this.lowValue=0;this.highValue=0;this.sliderElem=sliderElem;this.range=this.scope.rzSliderModel!==undefined&&this.scope.rzSliderHigh!==undefined;this.dragging={active:false,value:0,difference:0,position:0,lowLimit:0,highLimit:0};this.positionProperty='left';this.dimensionProperty='width';this.handleHalfDim=0;this.maxPos=0;this.precision=0;this.step=1;this.tracking='';this.minValue=0;this.maxValue=0;this.valueRange=0;this.intermediateTicks=false;this.initHasRun=false;this.firstKeyDown=false;this.internalChange=false;this.cmbLabelShown=false;this.currentFocusElement=null;this.fullBar=null;this.selBar=null;this.minH=null;this.maxH=null;this.flrLab=null;this.ceilLab=null;this.minLab=null;this.maxLab=null;this.cmbLab=null;this.ticks=null;this.init();};Slider.prototype={init:function(){var thrLow,thrHigh,self=this;var calcDimFn=function(){self.calcViewDimensions();};this.applyOptions();this.syncLowValue();if(this.range)this.syncHighValue();this.initElemHandles();this.manageElementsStyle();this.setDisabledState();this.calcViewDimensions();this.setMinAndMax();this.addAccessibility();this.updateCeilLab();this.updateFloorLab();this.initHandles();this.manageEventsBindings();this.scope.$on('reCalcViewDimensions',calcDimFn);angular.element($window).on('resize',calcDimFn);this.initHasRun=true;thrLow=rzThrottle(function(){self.onLowHandleChange();},self.options.interval);thrHigh=rzThrottle(function(){self.onHighHandleChange();},self.options.interval);this.scope.$on('rzSliderForceRender',function(){self.resetLabelsValue();thrLow();if(self.range){thrHigh();}self.resetSlider();});this.scope.$watch('rzSliderOptions()',function(newValue,oldValue){if(newValue===oldValue)return;self.applyOptions();self.syncLowValue();if(self.range)self.syncHighValue();self.resetSlider();},true);this.scope.$watch('rzSliderModel',function(newValue,oldValue){if(self.internalChange)return;if(newValue===oldValue)return;thrLow();});this.scope.$watch('rzSliderHigh',function(newValue,oldValue){if(self.internalChange)return;if(newValue===oldValue)return;if(newValue!=null)thrHigh();if(self.range&&newValue==null||!self.range&&newValue!=null){self.applyOptions();self.resetSlider();}});this.scope.$on('$destroy',function(){self.unbindEvents();angular.element($window).off('resize',calcDimFn);self.currentFocusElement=null;});},findStepIndex:function(modelValue){var index=0;for(var i=0;i<this.options.stepsArray.length;i++){var step=this.options.stepsArray[i];if(step===modelValue){index=i;break;}else if(angular.isDate(step)){if(step.getTime()===modelValue.getTime()){index=i;break;}}else if(angular.isObject(step)){if(angular.isDate(step.value)&&step.value.getTime()===modelValue.getTime()||step.value===modelValue){index=i;break;}}}return index;},syncLowValue:function(){if(this.options.stepsArray){if(!this.options.bindIndexForStepsArray)this.lowValue=this.findStepIndex(this.scope.rzSliderModel);else
this.lowValue=this.scope.rzSliderModel}else
this.lowValue=this.scope.rzSliderModel;},syncHighValue:function(){if(this.options.stepsArray){if(!this.options.bindIndexForStepsArray)this.highValue=this.findStepIndex(this.scope.rzSliderHigh);else
this.highValue=this.scope.rzSliderHigh}else
this.highValue=this.scope.rzSliderHigh;},getStepValue:function(sliderValue){var step=this.options.stepsArray[sliderValue];if(angular.isDate(step))return step;if(angular.isObject(step))return step.value;return step;},applyLowValue:function(){if(this.options.stepsArray){if(!this.options.bindIndexForStepsArray)this.scope.rzSliderModel=this.getStepValue(this.lowValue);else
this.scope.rzSliderModel=this.lowValue}else
this.scope.rzSliderModel=this.lowValue;},applyHighValue:function(){if(this.options.stepsArray){if(!this.options.bindIndexForStepsArray)this.scope.rzSliderHigh=this.getStepValue(this.highValue);else
this.scope.rzSliderHigh=this.highValue}else
this.scope.rzSliderHigh=this.highValue;},onLowHandleChange:function(){this.syncLowValue();if(this.range)this.syncHighValue();this.setMinAndMax();this.updateLowHandle(this.valueToPosition(this.lowValue));this.updateSelectionBar();this.updateTicksScale();this.updateAriaAttributes();if(this.range){this.updateCmbLabel();}},onHighHandleChange:function(){this.syncLowValue();this.syncHighValue();this.setMinAndMax();this.updateHighHandle(this.valueToPosition(this.highValue));this.updateSelectionBar();this.updateTicksScale();this.updateCmbLabel();this.updateAriaAttributes();},applyOptions:function(){var sliderOptions;if(this.scope.rzSliderOptions)sliderOptions=this.scope.rzSliderOptions();else
sliderOptions={};this.options=RzSliderOptions.getOptions(sliderOptions);if(this.options.step<=0)this.options.step=1;this.range=this.scope.rzSliderModel!==undefined&&this.scope.rzSliderHigh!==undefined;this.options.draggableRange=this.range&&this.options.draggableRange;this.options.draggableRangeOnly=this.range&&this.options.draggableRangeOnly;if(this.options.draggableRangeOnly){this.options.draggableRange=true;}this.options.showTicks=this.options.showTicks||this.options.showTicksValues||!!this.options.ticksArray;this.scope.showTicks=this.options.showTicks;if(angular.isNumber(this.options.showTicks)||this.options.ticksArray)this.intermediateTicks=true;this.options.showSelectionBar=this.options.showSelectionBar||this.options.showSelectionBarEnd||this.options.showSelectionBarFromValue!==null;if(this.options.stepsArray){this.parseStepsArray();}else{if(this.options.translate)this.customTrFn=this.options.translate;else
this.customTrFn=function(value){return String(value);};this.getLegend=this.options.getLegend;}if(this.options.vertical){this.positionProperty='bottom';this.dimensionProperty='height';}if(this.options.customTemplateScope)this.scope.custom=this.options.customTemplateScope;},parseStepsArray:function(){this.options.floor=0;this.options.ceil=this.options.stepsArray.length-1;this.options.step=1;if(this.options.translate){this.customTrFn=this.options.translate;}else{this.customTrFn=function(modelValue){if(this.options.bindIndexForStepsArray)return this.getStepValue(modelValue);return modelValue;};}this.getLegend=function(index){var step=this.options.stepsArray[index];if(angular.isObject(step))return step.legend;return null;};},resetSlider:function(){this.manageElementsStyle();this.addAccessibility();this.setMinAndMax();this.updateCeilLab();this.updateFloorLab();this.unbindEvents();this.manageEventsBindings();this.setDisabledState();this.calcViewDimensions();this.refocusPointerIfNeeded();},refocusPointerIfNeeded:function(){if(this.currentFocusElement){this.onPointerFocus(this.currentFocusElement.pointer,this.currentFocusElement.ref);this.focusElement(this.currentFocusElement.pointer)}},initElemHandles:function(){angular.forEach(this.sliderElem.children(),function(elem,index){var jElem=angular.element(elem);switch(index){case 0:this.fullBar=jElem;break;case 1:this.selBar=jElem;break;case 2:this.minH=jElem;break;case 3:this.maxH=jElem;break;case 4:this.flrLab=jElem;break;case 5:this.ceilLab=jElem;break;case 6:this.minLab=jElem;break;case 7:this.maxLab=jElem;break;case 8:this.cmbLab=jElem;break;case 9:this.ticks=jElem;break;}},this);this.selBar.rzsp=0;this.minH.rzsp=0;this.maxH.rzsp=0;this.flrLab.rzsp=0;this.ceilLab.rzsp=0;this.minLab.rzsp=0;this.maxLab.rzsp=0;this.cmbLab.rzsp=0;},manageElementsStyle:function(){if(!this.range)this.maxH.css('display','none');else
this.maxH.css('display','');this.alwaysHide(this.flrLab,this.options.showTicksValues||this.options.hideLimitLabels);this.alwaysHide(this.ceilLab,this.options.showTicksValues||this.options.hideLimitLabels);var hideLabelsForTicks=this.options.showTicksValues&&!this.intermediateTicks;this.alwaysHide(this.minLab,hideLabelsForTicks||this.options.hidePointerLabels);this.alwaysHide(this.maxLab,hideLabelsForTicks||!this.range||this.options.hidePointerLabels);this.alwaysHide(this.cmbLab,hideLabelsForTicks||!this.range||this.options.hidePointerLabels);this.alwaysHide(this.selBar,!this.range&&!this.options.showSelectionBar);if(this.options.vertical)this.sliderElem.addClass('rz-vertical');if(this.options.draggableRange)this.selBar.addClass('rz-draggable');else
this.selBar.removeClass('rz-draggable');if(this.intermediateTicks&&this.options.showTicksValues)this.ticks.addClass('rz-ticks-values-under');},alwaysHide:function(el,hide){el.rzAlwaysHide=hide;if(hide)this.hideEl(el);else
this.showEl(el)},manageEventsBindings:function(){if(this.options.disabled||this.options.readOnly)this.unbindEvents();else
this.bindEvents();},setDisabledState:function(){if(this.options.disabled){this.sliderElem.attr('disabled','disabled');}else{this.sliderElem.attr('disabled',null);}},resetLabelsValue:function(){this.minLab.rzsv=undefined;this.maxLab.rzsv=undefined;},initHandles:function(){this.updateLowHandle(this.valueToPosition(this.lowValue));if(this.range)this.updateHighHandle(this.valueToPosition(this.highValue));this.updateSelectionBar();if(this.range)this.updateCmbLabel();this.updateTicksScale();},translateFn:function(value,label,which,useCustomTr){useCustomTr=useCustomTr===undefined?true:useCustomTr;var valStr='',getDimension=false,noLabelInjection=label.hasClass('no-label-injection');if(useCustomTr){if(this.options.stepsArray&&!this.options.bindIndexForStepsArray)value=this.getStepValue(value);valStr=String(this.customTrFn(value,this.options.id,which));}else{valStr=String(value)}if(label.rzsv===undefined||label.rzsv.length!==valStr.length||(label.rzsv.length>0&&label.rzsd===0)){getDimension=true;label.rzsv=valStr;}if(!noLabelInjection){label.html(valStr);};this.scope[which+'Label']=valStr;if(getDimension){this.getDimension(label);}},setMinAndMax:function(){this.step=+this.options.step;this.precision=+this.options.precision;this.minValue=this.options.floor;if(this.options.logScale&&this.minValue===0)throw Error("Can't use floor=0 with logarithmic scale");if(this.options.enforceStep){this.lowValue=this.roundStep(this.lowValue);if(this.range)this.highValue=this.roundStep(this.highValue);}if(this.options.ceil!=null)this.maxValue=this.options.ceil;else
this.maxValue=this.options.ceil=this.range?this.highValue:this.lowValue;if(this.options.enforceRange){this.lowValue=this.sanitizeValue(this.lowValue);if(this.range)this.highValue=this.sanitizeValue(this.highValue);}this.applyLowValue();if(this.range)this.applyHighValue();this.valueRange=this.maxValue-this.minValue;},addAccessibility:function(){this.minH.attr('role','slider');this.updateAriaAttributes();if(this.options.keyboardSupport&&!(this.options.readOnly||this.options.disabled))this.minH.attr('tabindex','0');else
this.minH.attr('tabindex','');if(this.options.vertical)this.minH.attr('aria-orientation','vertical');if(this.range){this.maxH.attr('role','slider');if(this.options.keyboardSupport&&!(this.options.readOnly||this.options.disabled))this.maxH.attr('tabindex','0');else
this.maxH.attr('tabindex','');if(this.options.vertical)this.maxH.attr('aria-orientation','vertical');}},updateAriaAttributes:function(){this.minH.attr({'aria-valuenow':this.scope.rzSliderModel,'aria-valuetext':this.customTrFn(this.scope.rzSliderModel,this.options.id,'model'),'aria-valuemin':this.minValue,'aria-valuemax':this.maxValue});if(this.range){this.maxH.attr({'aria-valuenow':this.scope.rzSliderHigh,'aria-valuetext':this.customTrFn(this.scope.rzSliderHigh,this.options.id,'high'),'aria-valuemin':this.minValue,'aria-valuemax':this.maxValue});}},calcViewDimensions:function(){var handleWidth=this.getDimension(this.minH);this.handleHalfDim=handleWidth/2;this.barDimension=this.getDimension(this.fullBar);this.maxPos=this.barDimension-handleWidth;this.getDimension(this.sliderElem);this.sliderElem.rzsp=this.sliderElem[0].getBoundingClientRect()[this.positionProperty];if(this.initHasRun){this.updateFloorLab();this.updateCeilLab();this.initHandles();var self=this;$timeout(function(){self.updateTicksScale();});}},updateTicksScale:function(){if(!this.options.showTicks)return;var ticksArray=this.options.ticksArray||this.getTicksArray(),translate=this.options.vertical?'translateY':'translateX',self=this;if(this.options.rightToLeft)ticksArray.reverse();this.scope.ticks=ticksArray.map(function(value){var position=self.valueToPosition(value);if(self.options.vertical)position=self.maxPos-position;var tick={selected:self.isTickSelected(value),style:{transform:translate+'('+Math.round(position)+'px)'}};if(tick.selected&&self.options.getSelectionBarColor){tick.style['background-color']=self.getSelectionBarColor();}if(!tick.selected&&self.options.getTickColor){tick.style['background-color']=self.getTickColor(value);}if(self.options.ticksTooltip){tick.tooltip=self.options.ticksTooltip(value);tick.tooltipPlacement=self.options.vertical?'right':'top';}if(self.options.showTicksValues){tick.value=self.getDisplayValue(value,'tick-value');if(self.options.ticksValuesTooltip){tick.valueTooltip=self.options.ticksValuesTooltip(value);tick.valueTooltipPlacement=self.options.vertical?'right':'top';}}if(self.getLegend){var legend=self.getLegend(value,self.options.id);if(legend)tick.legend=legend;}return tick;});},getTicksArray:function(){var step=this.step,ticksArray=[];if(this.intermediateTicks)step=this.options.showTicks;for(var value=this.minValue;value<=this.maxValue;value+=step){ticksArray.push(value);}return ticksArray;},isTickSelected:function(value){if(!this.range){if(this.options.showSelectionBarFromValue!==null){var center=this.options.showSelectionBarFromValue;if(this.lowValue>center&&value>=center&&value<=this.lowValue)return true;else if(this.lowValue<center&&value<=center&&value>=this.lowValue)return true;}else if(this.options.showSelectionBarEnd){if(value>=this.lowValue)return true;}else if(this.options.showSelectionBar&&value<=this.lowValue)return true;}if(this.range&&value>=this.lowValue&&value<=this.highValue)return true;return false;},updateFloorLab:function(){this.translateFn(this.minValue,this.flrLab,'floor');this.getDimension(this.flrLab);var position=this.options.rightToLeft?this.barDimension-this.flrLab.rzsd:0;this.setPosition(this.flrLab,position);},updateCeilLab:function(){this.translateFn(this.maxValue,this.ceilLab,'ceil');this.getDimension(this.ceilLab);var position=this.options.rightToLeft?0:this.barDimension-this.ceilLab.rzsd;this.setPosition(this.ceilLab,position);},updateHandles:function(which,newPos){if(which==='lowValue')this.updateLowHandle(newPos);else
this.updateHighHandle(newPos);this.updateSelectionBar();this.updateTicksScale();if(this.range)this.updateCmbLabel();},getHandleLabelPos:function(labelName,newPos){var labelRzsd=this[labelName].rzsd,nearHandlePos=newPos-labelRzsd/2+this.handleHalfDim,endOfBarPos=this.barDimension-labelRzsd;if(!this.options.boundPointerLabels)return nearHandlePos;if(this.options.rightToLeft&&labelName==='minLab'||!this.options.rightToLeft&&labelName==='maxLab'){return Math.min(nearHandlePos,endOfBarPos);}else{return Math.min(Math.max(nearHandlePos,0),endOfBarPos);}},updateLowHandle:function(newPos){this.setPosition(this.minH,newPos);this.translateFn(this.lowValue,this.minLab,'model');this.setPosition(this.minLab,this.getHandleLabelPos('minLab',newPos));if(this.options.getPointerColor){var pointercolor=this.getPointerColor('min');this.scope.minPointerStyle={backgroundColor:pointercolor};}if(this.options.autoHideLimitLabels){this.shFloorCeil();}},updateHighHandle:function(newPos){this.setPosition(this.maxH,newPos);this.translateFn(this.highValue,this.maxLab,'high');this.setPosition(this.maxLab,this.getHandleLabelPos('maxLab',newPos));if(this.options.getPointerColor){var pointercolor=this.getPointerColor('max');this.scope.maxPointerStyle={backgroundColor:pointercolor};}if(this.options.autoHideLimitLabels){this.shFloorCeil();}},shFloorCeil:function(){if(this.options.hidePointerLabels){return;}var flHidden=false,clHidden=false,isMinLabAtFloor=this.isLabelBelowFloorLab(this.minLab),isMinLabAtCeil=this.isLabelAboveCeilLab(this.minLab),isMaxLabAtCeil=this.isLabelAboveCeilLab(this.maxLab),isCmbLabAtFloor=this.isLabelBelowFloorLab(this.cmbLab),isCmbLabAtCeil=this.isLabelAboveCeilLab(this.cmbLab);if(isMinLabAtFloor){flHidden=true;this.hideEl(this.flrLab);}else{flHidden=false;this.showEl(this.flrLab);}if(isMinLabAtCeil){clHidden=true;this.hideEl(this.ceilLab);}else{clHidden=false;this.showEl(this.ceilLab);}if(this.range){var hideCeil=this.cmbLabelShown?isCmbLabAtCeil:isMaxLabAtCeil;var hideFloor=this.cmbLabelShown?isCmbLabAtFloor:isMinLabAtFloor;if(hideCeil){this.hideEl(this.ceilLab);}else if(!clHidden){this.showEl(this.ceilLab);}if(hideFloor){this.hideEl(this.flrLab);}else if(!flHidden){this.showEl(this.flrLab);}}},isLabelBelowFloorLab:function(label){var isRTL=this.options.rightToLeft,pos=label.rzsp,dim=label.rzsd,floorPos=this.flrLab.rzsp,floorDim=this.flrLab.rzsd;return isRTL?pos+dim>=floorPos-2:pos<=floorPos+floorDim+2;},isLabelAboveCeilLab:function(label){var isRTL=this.options.rightToLeft,pos=label.rzsp,dim=label.rzsd,ceilPos=this.ceilLab.rzsp,ceilDim=this.ceilLab.rzsd;return isRTL?pos<=ceilPos+ceilDim+2:pos+dim>=ceilPos-2;},updateSelectionBar:function(){var position=0,dimension=0,isSelectionBarFromRight=this.options.rightToLeft?!this.options.showSelectionBarEnd:this.options.showSelectionBarEnd,positionForRange=this.options.rightToLeft?this.maxH.rzsp+this.handleHalfDim:this.minH.rzsp+this.handleHalfDim;if(this.range){dimension=Math.abs(this.maxH.rzsp-this.minH.rzsp);position=positionForRange;}else{if(this.options.showSelectionBarFromValue!==null){var center=this.options.showSelectionBarFromValue,centerPosition=this.valueToPosition(center),isModelGreaterThanCenter=this.options.rightToLeft?this.lowValue<=center:this.lowValue>center;if(isModelGreaterThanCenter){dimension=this.minH.rzsp-centerPosition;position=centerPosition+this.handleHalfDim;}else{dimension=centerPosition-this.minH.rzsp;position=this.minH.rzsp+this.handleHalfDim;}}else if(isSelectionBarFromRight){dimension=Math.abs(this.maxPos-this.minH.rzsp)+this.handleHalfDim;position=this.minH.rzsp+this.handleHalfDim;}else{dimension=Math.abs(this.maxH.rzsp-this.minH.rzsp)+this.handleHalfDim;position=0;}}this.setDimension(this.selBar,dimension);this.setPosition(this.selBar,position);if(this.options.getSelectionBarColor){var color=this.getSelectionBarColor();this.scope.barStyle={backgroundColor:color};}else if(this.options.selectionBarGradient){var offset=this.options.showSelectionBarFromValue!==null?this.valueToPosition(this.options.showSelectionBarFromValue):0,reversed=offset-position>0^isSelectionBarFromRight,direction=this.options.vertical?(reversed?'bottom':'top'):(reversed?'left':'right');this.scope.barStyle={backgroundImage:'linear-gradient(to '+direction+', '+this.options.selectionBarGradient.from+' 0%,'+this.options.selectionBarGradient.to+' 100%)'};if(this.options.vertical){this.scope.barStyle.backgroundPosition='center '+(offset+dimension+position+(reversed?-this.handleHalfDim:0))+'px';this.scope.barStyle.backgroundSize='100% '+(this.barDimension-this.handleHalfDim)+'px';}else{this.scope.barStyle.backgroundPosition=(offset-position+(reversed?this.handleHalfDim:0))+'px center';this.scope.barStyle.backgroundSize=(this.barDimension-this.handleHalfDim)+'px 100%';}}},getSelectionBarColor:function(){if(this.range)return this.options.getSelectionBarColor(this.scope.rzSliderModel,this.scope.rzSliderHigh);return this.options.getSelectionBarColor(this.scope.rzSliderModel);},getPointerColor:function(pointerType){if(pointerType==='max'){return this.options.getPointerColor(this.scope.rzSliderHigh,pointerType);}return this.options.getPointerColor(this.scope.rzSliderModel,pointerType);},getTickColor:function(value){return this.options.getTickColor(value);},updateCmbLabel:function(){var isLabelOverlap=null;if(this.options.rightToLeft){isLabelOverlap=this.minLab.rzsp-this.minLab.rzsd-10<=this.maxLab.rzsp;}else{isLabelOverlap=this.minLab.rzsp+this.minLab.rzsd+10>=this.maxLab.rzsp;}if(isLabelOverlap){var lowTr=this.getDisplayValue(this.lowValue,'model'),highTr=this.getDisplayValue(this.highValue,'high'),labelVal='';if(this.options.mergeRangeLabelsIfSame&&lowTr===highTr){labelVal=lowTr;}else{labelVal=this.options.rightToLeft?highTr+' - '+lowTr:lowTr+' - '+highTr;}this.translateFn(labelVal,this.cmbLab,'cmb',false);var pos=this.options.boundPointerLabels?Math.min(Math.max(this.selBar.rzsp+this.selBar.rzsd/2-this.cmbLab.rzsd/2,0),this.barDimension-this.cmbLab.rzsd):this.selBar.rzsp+this.selBar.rzsd/2-this.cmbLab.rzsd/2;this.setPosition(this.cmbLab,pos);this.cmbLabelShown=true;this.hideEl(this.minLab);this.hideEl(this.maxLab);this.showEl(this.cmbLab);}else{this.cmbLabelShown=false;this.showEl(this.maxLab);this.showEl(this.minLab);this.hideEl(this.cmbLab);}if(this.options.autoHideLimitLabels){this.shFloorCeil();}},getDisplayValue:function(value,which){if(this.options.stepsArray&&!this.options.bindIndexForStepsArray){value=this.getStepValue(value);}return this.customTrFn(value,this.options.id,which);},roundStep:function(value,customStep){var step=customStep?customStep:this.step,steppedDifference=parseFloat((value-this.minValue)/step).toPrecision(12);steppedDifference=Math.round(+steppedDifference)*step;var newValue=(this.minValue+steppedDifference).toFixed(this.precision);return+newValue;},hideEl:function(element){return element.css({visibility:'hidden'});},showEl:function(element){if(!!element.rzAlwaysHide){return element;}return element.css({visibility:'visible'});},setPosition:function(elem,pos){elem.rzsp=pos;var css={};css[this.positionProperty]=Math.round(pos)+'px';elem.css(css);return pos;},getDimension:function(elem){var val=elem[0].getBoundingClientRect();if(this.options.vertical)elem.rzsd=(val.bottom-val.top)*this.options.scale;else
elem.rzsd=(val.right-val.left)*this.options.scale;return elem.rzsd;},setDimension:function(elem,dim){elem.rzsd=dim;var css={};css[this.dimensionProperty]=Math.round(dim)+'px';elem.css(css);return dim;},sanitizeValue:function(val){return Math.min(Math.max(val,this.minValue),this.maxValue);},valueToPosition:function(val){var fn=this.linearValueToPosition;if(this.options.customValueToPosition)fn=this.options.customValueToPosition;else if(this.options.logScale)fn=this.logValueToPosition;val=this.sanitizeValue(val);var percent=fn(val,this.minValue,this.maxValue)||0;if(this.options.rightToLeft)percent=1-percent;return percent*this.maxPos;},linearValueToPosition:function(val,minVal,maxVal){var range=maxVal-minVal;return(val-minVal)/range;},logValueToPosition:function(val,minVal,maxVal){val=Math.log(val);minVal=Math.log(minVal);maxVal=Math.log(maxVal);var range=maxVal-minVal;return(val-minVal)/range;},positionToValue:function(position){var percent=position/this.maxPos;if(this.options.rightToLeft)percent=1-percent;var fn=this.linearPositionToValue;if(this.options.customPositionToValue)fn=this.options.customPositionToValue;else if(this.options.logScale)fn=this.logPositionToValue;return fn(percent,this.minValue,this.maxValue)||0;},linearPositionToValue:function(percent,minVal,maxVal){return percent*(maxVal-minVal)+minVal;},logPositionToValue:function(percent,minVal,maxVal){minVal=Math.log(minVal);maxVal=Math.log(maxVal);var value=percent*(maxVal-minVal)+minVal;return Math.exp(value);},getEventXY:function(event){var clientXY=this.options.vertical?'clientY':'clientX';if(event[clientXY]!==undefined){return event[clientXY];}return event.originalEvent===undefined?event.touches[0][clientXY]:event.originalEvent.touches[0][clientXY];},getEventPosition:function(event){var sliderPos=this.sliderElem.rzsp,eventPos=0;if(this.options.vertical)eventPos=-this.getEventXY(event)+sliderPos;else
eventPos=this.getEventXY(event)-sliderPos;return eventPos*this.options.scale-this.handleHalfDim;},getEventNames:function(event){var eventNames={moveEvent:'',endEvent:''};if(event.touches||(event.originalEvent!==undefined&&event.originalEvent.touches)){eventNames.moveEvent='touchmove';eventNames.endEvent='touchend';}else{eventNames.moveEvent='mousemove';eventNames.endEvent='mouseup';}return eventNames;},getNearestHandle:function(event){if(!this.range){return this.minH;}var position=this.getEventPosition(event),distanceMin=Math.abs(position-this.minH.rzsp),distanceMax=Math.abs(position-this.maxH.rzsp);if(distanceMin<distanceMax)return this.minH;else if(distanceMin>distanceMax)return this.maxH;else if(!this.options.rightToLeft)return position<this.minH.rzsp?this.minH:this.maxH;else
return position>this.minH.rzsp?this.minH:this.maxH;},focusElement:function(el){var DOM_ELEMENT=0;el[DOM_ELEMENT].focus();},bindEvents:function(){var barTracking,barStart,barMove;if(this.options.draggableRange){barTracking='rzSliderDrag';barStart=this.onDragStart;barMove=this.onDragMove;}else{barTracking='lowValue';barStart=this.onStart;barMove=this.onMove;}if(!this.options.onlyBindHandles){this.selBar.on('mousedown',angular.bind(this,barStart,null,barTracking));this.selBar.on('mousedown',angular.bind(this,barMove,this.selBar));}if(this.options.draggableRangeOnly){this.minH.on('mousedown',angular.bind(this,barStart,null,barTracking));this.maxH.on('mousedown',angular.bind(this,barStart,null,barTracking));}else{this.minH.on('mousedown',angular.bind(this,this.onStart,this.minH,'lowValue'));if(this.range){this.maxH.on('mousedown',angular.bind(this,this.onStart,this.maxH,'highValue'));}if(!this.options.onlyBindHandles){this.fullBar.on('mousedown',angular.bind(this,this.onStart,null,null));this.fullBar.on('mousedown',angular.bind(this,this.onMove,this.fullBar));this.ticks.on('mousedown',angular.bind(this,this.onStart,null,null));this.ticks.on('mousedown',angular.bind(this,this.onTickClick,this.ticks));}}if(!this.options.onlyBindHandles){this.selBar.on('touchstart',angular.bind(this,barStart,null,barTracking));this.selBar.on('touchstart',angular.bind(this,barMove,this.selBar));}if(this.options.draggableRangeOnly){this.minH.on('touchstart',angular.bind(this,barStart,null,barTracking));this.maxH.on('touchstart',angular.bind(this,barStart,null,barTracking));}else{this.minH.on('touchstart',angular.bind(this,this.onStart,this.minH,'lowValue'));if(this.range){this.maxH.on('touchstart',angular.bind(this,this.onStart,this.maxH,'highValue'));}if(!this.options.onlyBindHandles){this.fullBar.on('touchstart',angular.bind(this,this.onStart,null,null));this.fullBar.on('touchstart',angular.bind(this,this.onMove,this.fullBar));this.ticks.on('touchstart',angular.bind(this,this.onStart,null,null));this.ticks.on('touchstart',angular.bind(this,this.onTickClick,this.ticks));}}if(this.options.keyboardSupport){this.minH.on('focus',angular.bind(this,this.onPointerFocus,this.minH,'lowValue'));if(this.range){this.maxH.on('focus',angular.bind(this,this.onPointerFocus,this.maxH,'highValue'));}}},unbindEvents:function(){this.minH.off();this.maxH.off();this.fullBar.off();this.selBar.off();this.ticks.off();},onStart:function(pointer,ref,event){var ehMove,ehEnd,eventNames=this.getEventNames(event);event.stopPropagation();event.preventDefault();this.calcViewDimensions();if(pointer){this.tracking=ref;}else{pointer=this.getNearestHandle(event);this.tracking=pointer===this.minH?'lowValue':'highValue';}pointer.addClass('rz-active');if(this.options.keyboardSupport)this.focusElement(pointer);ehMove=angular.bind(this,this.dragging.active?this.onDragMove:this.onMove,pointer);ehEnd=angular.bind(this,this.onEnd,ehMove);$document.on(eventNames.moveEvent,ehMove);$document.one(eventNames.endEvent,ehEnd);this.callOnStart();},onMove:function(pointer,event,fromTick){var newPos=this.getEventPosition(event),newValue,ceilValue=this.options.rightToLeft?this.minValue:this.maxValue,flrValue=this.options.rightToLeft?this.maxValue:this.minValue;if(newPos<=0){newValue=flrValue;}else if(newPos>=this.maxPos){newValue=ceilValue;}else{newValue=this.positionToValue(newPos);if(fromTick&&angular.isNumber(this.options.showTicks))newValue=this.roundStep(newValue,this.options.showTicks);else
newValue=this.roundStep(newValue);}this.positionTrackingHandle(newValue);},onEnd:function(ehMove,event){var moveEventName=this.getEventNames(event).moveEvent;if(!this.options.keyboardSupport){this.minH.removeClass('rz-active');this.maxH.removeClass('rz-active');this.tracking='';}this.dragging.active=false;$document.off(moveEventName,ehMove);this.callOnEnd();},onTickClick:function(pointer,event){this.onMove(pointer,event,true);},onPointerFocus:function(pointer,ref){this.tracking=ref;pointer.one('blur',angular.bind(this,this.onPointerBlur,pointer));pointer.on('keydown',angular.bind(this,this.onKeyboardEvent));pointer.on('keyup',angular.bind(this,this.onKeyUp));this.firstKeyDown=true;pointer.addClass('rz-active');this.currentFocusElement={pointer:pointer,ref:ref};},onKeyUp:function(){this.firstKeyDown=true;this.callOnEnd();},onPointerBlur:function(pointer){pointer.off('keydown');pointer.off('keyup');this.tracking='';pointer.removeClass('rz-active');this.currentFocusElement=null},getKeyActions:function(currentValue){var increaseStep=currentValue+this.step,decreaseStep=currentValue-this.step,increasePage=currentValue+this.valueRange/10,decreasePage=currentValue-this.valueRange/10;var actions={'UP':increaseStep,'DOWN':decreaseStep,'LEFT':decreaseStep,'RIGHT':increaseStep,'PAGEUP':increasePage,'PAGEDOWN':decreasePage,'HOME':this.minValue,'END':this.maxValue};if(this.options.rightToLeft){actions.LEFT=increaseStep;actions.RIGHT=decreaseStep;if(this.options.vertical){actions.UP=decreaseStep;actions.DOWN=increaseStep;}}return actions;},onKeyboardEvent:function(event){var currentValue=this[this.tracking],keyCode=event.keyCode||event.which,keys={38:'UP',40:'DOWN',37:'LEFT',39:'RIGHT',33:'PAGEUP',34:'PAGEDOWN',36:'HOME',35:'END'},actions=this.getKeyActions(currentValue),key=keys[keyCode],action=actions[key];if(action==null||this.tracking==='')return;event.preventDefault();if(this.firstKeyDown){this.firstKeyDown=false;this.callOnStart();}var self=this;$timeout(function(){var newValue=self.roundStep(self.sanitizeValue(action));if(!self.options.draggableRangeOnly){self.positionTrackingHandle(newValue);}else{var difference=self.highValue-self.lowValue,newMinValue,newMaxValue;if(self.tracking==='lowValue'){newMinValue=newValue;newMaxValue=newValue+difference;if(newMaxValue>self.maxValue){newMaxValue=self.maxValue;newMinValue=newMaxValue-difference;}}else{newMaxValue=newValue;newMinValue=newValue-difference;if(newMinValue<self.minValue){newMinValue=self.minValue;newMaxValue=newMinValue+difference;}}self.positionTrackingBar(newMinValue,newMaxValue);}});},onDragStart:function(pointer,ref,event){var position=this.getEventPosition(event);this.dragging={active:true,value:this.positionToValue(position),difference:this.highValue-this.lowValue,lowLimit:this.options.rightToLeft?this.minH.rzsp-position:position-this.minH.rzsp,highLimit:this.options.rightToLeft?position-this.maxH.rzsp:this.maxH.rzsp-position};this.onStart(pointer,ref,event);},getValue:function(type,newPos,outOfBounds,isAbove){var isRTL=this.options.rightToLeft,value=null;if(type==='min'){if(outOfBounds){if(isAbove){value=isRTL?this.minValue:this.maxValue-this.dragging.difference;}else{value=isRTL?this.maxValue-this.dragging.difference:this.minValue;}}else{value=isRTL?this.positionToValue(newPos+this.dragging.lowLimit):this.positionToValue(newPos-this.dragging.lowLimit)}}else{if(outOfBounds){if(isAbove){value=isRTL?this.minValue+this.dragging.difference:this.maxValue;}else{value=isRTL?this.maxValue:this.minValue+this.dragging.difference;}}else{if(isRTL){value=this.positionToValue(newPos+this.dragging.lowLimit)+this.dragging.difference}else{value=this.positionToValue(newPos-this.dragging.lowLimit)+this.dragging.difference;}}}return this.roundStep(value);},onDragMove:function(pointer,event){var newPos=this.getEventPosition(event),newMinValue,newMaxValue,ceilLimit,flrLimit,isUnderFlrLimit,isOverCeilLimit,flrH,ceilH;if(this.options.rightToLeft){ceilLimit=this.dragging.lowLimit;flrLimit=this.dragging.highLimit;flrH=this.maxH;ceilH=this.minH;}else{ceilLimit=this.dragging.highLimit;flrLimit=this.dragging.lowLimit;flrH=this.minH;ceilH=this.maxH;}isUnderFlrLimit=newPos<=flrLimit;isOverCeilLimit=newPos>=this.maxPos-ceilLimit;if(isUnderFlrLimit){if(flrH.rzsp===0)return;newMinValue=this.getValue('min',newPos,true,false);newMaxValue=this.getValue('max',newPos,true,false);}else if(isOverCeilLimit){if(ceilH.rzsp===this.maxPos)return;newMaxValue=this.getValue('max',newPos,true,true);newMinValue=this.getValue('min',newPos,true,true);}else{newMinValue=this.getValue('min',newPos,false);newMaxValue=this.getValue('max',newPos,false);}this.positionTrackingBar(newMinValue,newMaxValue);},positionTrackingBar:function(newMinValue,newMaxValue){if(this.options.minLimit!=null&&newMinValue<this.options.minLimit){newMinValue=this.options.minLimit;newMaxValue=newMinValue+this.dragging.difference;}if(this.options.maxLimit!=null&&newMaxValue>this.options.maxLimit){newMaxValue=this.options.maxLimit;newMinValue=newMaxValue-this.dragging.difference;}this.lowValue=newMinValue;this.highValue=newMaxValue;this.applyLowValue();if(this.range)this.applyHighValue();this.applyModel();this.updateHandles('lowValue',this.valueToPosition(newMinValue));this.updateHandles('highValue',this.valueToPosition(newMaxValue));},positionTrackingHandle:function(newValue){var valueChanged=false;newValue=this.applyMinMaxLimit(newValue);if(this.range){if(this.options.pushRange){newValue=this.applyPushRange(newValue);valueChanged=true;}else{if(this.options.noSwitching){if(this.tracking==='lowValue'&&newValue>this.highValue)newValue=this.applyMinMaxRange(this.highValue);else if(this.tracking==='highValue'&&newValue<this.lowValue)newValue=this.applyMinMaxRange(this.lowValue);}newValue=this.applyMinMaxRange(newValue);if(this.tracking==='lowValue'&&newValue>this.highValue){this.lowValue=this.highValue;this.applyLowValue();this.updateHandles(this.tracking,this.maxH.rzsp);this.updateAriaAttributes();this.tracking='highValue';this.minH.removeClass('rz-active');this.maxH.addClass('rz-active');if(this.options.keyboardSupport)this.focusElement(this.maxH);valueChanged=true;}else if(this.tracking==='highValue'&&newValue<this.lowValue){this.highValue=this.lowValue;this.applyHighValue();this.updateHandles(this.tracking,this.minH.rzsp);this.updateAriaAttributes();this.tracking='lowValue';this.maxH.removeClass('rz-active');this.minH.addClass('rz-active');if(this.options.keyboardSupport)this.focusElement(this.minH);valueChanged=true;}}}if(this[this.tracking]!==newValue){this[this.tracking]=newValue;if(this.tracking==='lowValue')this.applyLowValue();else
this.applyHighValue();this.updateHandles(this.tracking,this.valueToPosition(newValue));this.updateAriaAttributes();valueChanged=true;}if(valueChanged)this.applyModel();},applyMinMaxLimit:function(newValue){if(this.options.minLimit!=null&&newValue<this.options.minLimit)return this.options.minLimit;if(this.options.maxLimit!=null&&newValue>this.options.maxLimit)return this.options.maxLimit;return newValue;},applyMinMaxRange:function(newValue){var oppositeValue=this.tracking==='lowValue'?this.highValue:this.lowValue,difference=Math.abs(newValue-oppositeValue);if(this.options.minRange!=null){if(difference<this.options.minRange){if(this.tracking==='lowValue')return this.highValue-this.options.minRange;else
return this.lowValue+this.options.minRange;}}if(this.options.maxRange!=null){if(difference>this.options.maxRange){if(this.tracking==='lowValue')return this.highValue-this.options.maxRange;else
return this.lowValue+this.options.maxRange;}}return newValue;},applyPushRange:function(newValue){var difference=this.tracking==='lowValue'?this.highValue-newValue:newValue-this.lowValue,minRange=this.options.minRange!==null?this.options.minRange:this.options.step,maxRange=this.options.maxRange;if(difference<minRange){if(this.tracking==='lowValue'){this.highValue=Math.min(newValue+minRange,this.maxValue);newValue=this.highValue-minRange;this.applyHighValue();this.updateHandles('highValue',this.valueToPosition(this.highValue));}else{this.lowValue=Math.max(newValue-minRange,this.minValue);newValue=this.lowValue+minRange;this.applyLowValue();this.updateHandles('lowValue',this.valueToPosition(this.lowValue));}this.updateAriaAttributes();}else if(maxRange!==null&&difference>maxRange){if(this.tracking==='lowValue'){this.highValue=newValue+maxRange;this.applyHighValue();this.updateHandles('highValue',this.valueToPosition(this.highValue));}else{this.lowValue=newValue-maxRange;this.applyLowValue();this.updateHandles('lowValue',this.valueToPosition(this.lowValue));}this.updateAriaAttributes();}return newValue;},applyModel:function(){this.internalChange=true;this.scope.$apply();this.callOnChange();this.internalChange=false;},callOnStart:function(){if(this.options.onStart){var self=this,pointerType=this.tracking==='lowValue'?'min':'max';this.scope.$evalAsync(function(){self.options.onStart(self.options.id,self.scope.rzSliderModel,self.scope.rzSliderHigh,pointerType);});}},callOnChange:function(){if(this.options.onChange){var self=this,pointerType=this.tracking==='lowValue'?'min':'max';this.scope.$evalAsync(function(){self.options.onChange(self.options.id,self.scope.rzSliderModel,self.scope.rzSliderHigh,pointerType);});}},callOnEnd:function(){if(this.options.onEnd){var self=this,pointerType=this.tracking==='lowValue'?'min':'max';this.scope.$evalAsync(function(){self.options.onEnd(self.options.id,self.scope.rzSliderModel,self.scope.rzSliderHigh,pointerType);});}this.scope.$emit('slideEnded');}};return Slider;}]).directive('rzslider',['RzSlider',function(RzSlider){'use strict';return{restrict:'AE',replace:true,scope:{rzSliderModel:'=?',rzSliderHigh:'=?',rzSliderOptions:'&?',rzSliderTplUrl:'@'},templateUrl:function(elem,attrs){return attrs.rzSliderTplUrl||'rzSliderTpl.html';},link:function(scope,elem){scope.slider=new RzSlider(scope,elem);}};}]);module.run(['$templateCache',function($templateCache){'use strict';$templateCache.put('rzSliderTpl.html',"<div class=rzslider><span class=rz-bar-wrapper><span class=rz-bar></span></span> <span class=rz-bar-wrapper><span class=\"rz-bar rz-selection\" ng-style=barStyle></span></span> <span class=\"rz-pointer rz-pointer-min\" ng-style=minPointerStyle></span> <span class=\"rz-pointer rz-pointer-max\" ng-style=maxPointerStyle></span> <span class=\"rz-bubble rz-limit rz-floor\"></span> <span class=\"rz-bubble rz-limit rz-ceil\"></span> <span class=rz-bubble></span> <span class=rz-bubble></span> <span class=rz-bubble></span><ul ng-show=showTicks class=rz-ticks><li ng-repeat=\"t in ticks track by $index\" class=rz-tick ng-class=\"{'rz-selected': t.selected}\" ng-style=t.style ng-attr-uib-tooltip=\"{{ t.tooltip }}\" ng-attr-tooltip-placement={{t.tooltipPlacement}} ng-attr-tooltip-append-to-body=\"{{ t.tooltip ? true : undefined}}\"><span ng-if=\"t.value != null\" class=rz-tick-value ng-attr-uib-tooltip=\"{{ t.valueTooltip }}\" ng-attr-tooltip-placement={{t.valueTooltipPlacement}}>{{ t.value }}</span> <span ng-if=\"t.legend != null\" class=rz-tick-legend>{{ t.legend }}</span></li></ul></div>");}]);return module.name}));